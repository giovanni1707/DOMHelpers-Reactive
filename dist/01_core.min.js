/**
 * 01_dom-helpers
 *
 * DOM Helpers
 * High-performance vanilla JavaScript DOM utilities with intelligent caching
 *
 * Includes:
 * - Update Utility (Universal .update() method)
 * - Elements Helper (ID-based DOM access)
 * - Collections Helper (Class/Tag/Name-based DOM access)
 * - Selector Helper (querySelector/querySelectorAll with caching)
 *
 * @version 2.3.1
 * @license MIT
 */
!function(e){"use strict";"undefined"!=typeof process&&process.env&&"development"===process.env.NODE_ENV||"undefined"!=typeof location&&location.hostname;const t=!0,s=new WeakMap,n=new WeakMap;function r(e){return s.has(e)||s.set(e,{}),s.get(e)}function o(e,t,s){r(e)[t]=s}function i(e){return n.has(e)||n.set(e,new Map),n.get(e)}function a(e,t){if(e===t)return!0;if(null==e||null==t)return e===t;if(typeof e!=typeof t)return!1;if("object"==typeof e){if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((e,s)=>a(e,t[s]));const s=Object.keys(e),n=Object.keys(t);return s.length===n.length&&s.every(s=>a(e[s],t[s]))}return!1}function l(e,t,s,n){const r=i(e);r.has(t)||r.set(t,new Map);const o=r.get(t),a=s;o.has(a)||(e.addEventListener(t,s,n),o.set(a,{handler:s,options:n}))}function c(e,t=!1){return function(s={}){return s&&"object"==typeof s?t?u(e,s):h(e,s):(console.warn("[DOM Helpers] .update() called with invalid updates object"),e)}}function h(e,t){if(!e||!e.nodeType)return console.warn("[DOM Helpers] .update() called on null or invalid element"),e;try{Object.entries(t).forEach(([t,s])=>{d(e,t,s)})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e}function u(e,t){if(!e)return console.warn("[DOM Helpers] .update() called on null collection"),e;let s=[];if(void 0!==e.length)s=Array.from(e);else if(e._originalCollection)s=Array.from(e._originalCollection);else{if(!e._originalNodeList)return console.warn("[DOM Helpers] .update() called on unrecognized collection type"),e;s=Array.from(e._originalNodeList)}if(0===s.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{s.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,s])=>{d(e,t,s)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e}function d(e,t,s){try{const n=r(e);if("textContent"===t||"innerText"===t)return void(e[t]!==s&&n[t]!==s&&(e[t]=s,o(e,t,s)));if("innerHTML"===t)return void(e.innerHTML!==s&&n.innerHTML!==s&&(e.innerHTML=s,o(e,"innerHTML",s)));if("style"===t&&"object"==typeof s&&null!==s)return void function(e,t){const s=r(e),n=s.style||{};Object.entries(t).forEach(([t,s])=>{null!=s&&e.style[t]!==s&&n[t]!==s&&(e.style[t]=s,n[t]=s)}),s.style=n}(e,s);if("classList"===t&&"object"==typeof s&&null!==s)return void f(e,s);if("setAttribute"===t){if(Array.isArray(s)&&s.length>=2){const[t,n]=s;e.getAttribute(t)!==n&&e.setAttribute(t,n)}else"object"==typeof s&&null!==s&&Object.entries(s).forEach(([t,s])=>{e.getAttribute(t)!==s&&e.setAttribute(t,s)});return}if("removeAttribute"===t)return void(Array.isArray(s)?s.forEach(t=>{e.hasAttribute(t)&&e.removeAttribute(t)}):"string"==typeof s&&e.hasAttribute(s)&&e.removeAttribute(s));if("getAttribute"===t&&"string"==typeof s){const t=e.getAttribute(s);return void console.log(`[DOM Helpers] getAttribute('${s}'):`,t)}if("addEventListener"===t)return void function(e,t){if(Array.isArray(t)&&t.length>=2){const[s,n,r]=t,o=y(n);return void l(e,s,o,r)}if("object"==typeof t&&null!==t&&!Array.isArray(t))return void Object.entries(t).forEach(([t,s])=>{if("function"==typeof s){const n=y(s);l(e,t,n)}else if(Array.isArray(s)&&s.length>=1){const[n,r]=s;if("function"==typeof n){const s=y(n);l(e,t,s,r)}}});console.warn("[DOM Helpers] Invalid addEventListener value format")}(e,s);if("removeEventListener"===t&&Array.isArray(s)&&s.length>=2){const[t,n,r]=s;return void function(e,t,s,n){const r=i(e);if(r.has(t)){const o=r.get(t),i=s;o.has(i)&&(e.removeEventListener(t,s,n),o.delete(i),0===o.size&&r.delete(t))}}(e,t,n,r)}if("dataset"===t&&"object"==typeof s&&null!==s)return void Object.entries(s).forEach(([t,s])=>{e.dataset[t]!==s&&(e.dataset[t]=s)});if("function"==typeof e[t])return void(Array.isArray(s)?e[t](...s):e[t](s));if(t in e)return void(a(e[t],s)||a(n[t],s)||(e[t]=s,o(e,t,s)));if("string"==typeof s||"number"==typeof s||"boolean"==typeof s){const n=e.getAttribute(t),r=String(s);return void(n!==r&&e.setAttribute(t,r))}console.warn(`[DOM Helpers] Unknown property or method: ${t}`)}catch(e){console.warn(`[DOM Helpers] Failed to apply update ${t}: ${e.message}`)}}function p(e,t){if(Array.isArray(t)&&t.length>=2){const[s,n,r]=t,o=y(n);return void e.addEventListener(s,o,r)}"object"!=typeof t||null===t||Array.isArray(t)?console.warn("[DOM Helpers] Invalid addEventListener value format"):Object.entries(t).forEach(([t,s])=>{if("function"==typeof s){const n=y(s);e.addEventListener(t,n)}else if(Array.isArray(s)&&s.length>=1){const[n,r]=s;if("function"==typeof n){const s=y(n);e.addEventListener(t,s,r)}}})}function y(e){return function(t){return t.target&&!t.target.update&&m(t.target),this&&this.nodeType===Node.ELEMENT_NODE&&!this.update&&m(this),e.call(this,t)}}function f(e,t){Object.entries(t).forEach(([t,s])=>{try{switch(t){case"add":Array.isArray(s)?e.classList.add(...s):"string"==typeof s&&e.classList.add(s);break;case"remove":Array.isArray(s)?e.classList.remove(...s):"string"==typeof s&&e.classList.remove(s);break;case"toggle":Array.isArray(s)?s.forEach(t=>e.classList.toggle(t)):"string"==typeof s&&e.classList.toggle(s);break;case"replace":Array.isArray(s)&&2===s.length&&e.classList.replace(s[0],s[1]);break;case"contains":Array.isArray(s)?s.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof s&&console.log(`[DOM Helpers] classList.contains('${s}'):`,e.classList.contains(s));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}function m(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:c(e,!1),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=c(e,!1),e._hasEnhancedUpdateMethod=!0}return e}function g(e){if(!e||e._hasEnhancedUpdateMethod)return e;try{Object.defineProperty(e,"update",{value:c(e,!0),writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=c(e,!0),e._hasEnhancedUpdateMethod=!0}return e}function b(e){return e&&(void 0!==e.length||e._originalCollection||e._originalNodeList||e instanceof NodeList||e instanceof HTMLCollection)}const E={createEnhancedUpdateMethod:c,enhanceElementWithUpdate:m,enhanceCollectionWithUpdate:g,autoEnhanceWithUpdate:function(e){return e?b(e)?g(e):e.nodeType===Node.ELEMENT_NODE?m(e):e:e},isCollection:b,updateSingleElement:h,updateCollection:u,applyEnhancedUpdate:d,handleClassListUpdate:f,createUpdateExample:function(){return{textContent:"Enhanced Button",innerHTML:"<strong>Enhanced</strong> Button",id:"myEnhancedButton",className:"btn btn-primary",style:{color:"white",backgroundColor:"#007bff",padding:"10px 20px",border:"none",borderRadius:"5px"},classList:{add:["fancy","highlight"],remove:["old-class"],toggle:"active",replace:["btn-old","btn-new"]},setAttribute:["data-role","button"],removeAttribute:"disabled",dataset:{userId:"123",action:"submit"},addEventListener:["click",e=>{console.log("Button clicked!",e),e.target.classList.toggle("clicked")}],focus:[],scrollIntoView:[{behavior:"smooth"}]}}};let w;if("undefined"!=typeof module&&module.exports?module.exports=E:"function"==typeof define&&define.amd?define([],function(){return E}):e.EnhancedUpdateUtility=E,"undefined"!=typeof require)try{w=require("./update-utility.js")}catch(e){}else void 0!==e&&e.UpdateUtility&&(w=e.UpdateUtility);class A{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxy(),this._initMutationObserver(),this._scheduleCleanup()}_initProxy(){this.Elements=new Proxy(this,{get:(e,t)=>"symbol"==typeof t||t.startsWith("_")||"function"==typeof e[t]?e[t]:e._getElement(t),has:(e,t)=>e._hasElement(t),ownKeys:e=>e._getKeys(),getOwnPropertyDescriptor:(e,t)=>{if(e._hasElement(t))return{enumerable:!0,configurable:!0,value:e._getElement(t)}}})}_getElement(e){if("string"!=typeof e)return this._warn("Invalid element property type: "+typeof e),null;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return this.stats.hits++,this._enhanceElementWithUpdate(t);this.cache.delete(e)}const t=document.getElementById(e);return t?(this._addToCache(e,t),this.stats.misses++,this._enhanceElementWithUpdate(t)):(this.stats.misses++,this.options.enableLogging&&this._warn(`Element with id '${e}' not found`),null)}_hasElement(e){if("string"!=typeof e)return!1;if(this.cache.has(e)){const t=this.cache.get(e);if(t&&t.nodeType===Node.ELEMENT_NODE&&document.contains(t))return!0;this.cache.delete(e)}return!!document.getElementById(e)}_getKeys(){const e=document.querySelectorAll("[id]");return Array.from(e).map(e=>e.id).filter(e=>e)}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{id:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,s=new Set;e.forEach(e=>{if(e.addedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&t.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&t.add(e.id)})}catch(e){}}}),e.removedNodes.forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.id&&s.add(e.id);try{(e.querySelectorAll?e.querySelectorAll("[id]"):[]).forEach(e=>{e.id&&s.add(e.id)})}catch(e){}}}),"attributes"===e.type&&"id"===e.attributeName){const n=e.oldValue,r=e.target.id;n&&n!==r&&s.add(n),r&&r!==n&&t.add(r)}}),t.forEach(e=>{const t=document.getElementById(e);t&&this._addToCache(e,t)}),s.forEach(e=>{this.cache.delete(e)}),this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,s]of this.cache)s&&s.nodeType===Node.ELEMENT_NODE&&document.contains(s)&&s.id===t||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,n),t)}}_log(e){this.options.enableLogging&&console.log(`[Elements] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Elements] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasUpdateMethod)return e;if(E&&E.enhanceElementWithUpdate)return E.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,s])=>{if("style"!==t||"object"!=typeof s||null===s)if("classList"!==t||"object"!=typeof s||null===s)if("setAttribute"!==t)if("removeAttribute"!==t)if("dataset"!==t||"object"!=typeof s||null===s)if("addEventListener"!==t){if("removeEventListener"===t&&Array.isArray(s)&&s.length>=2){const[t,n,r]=s;return void e.removeEventListener(t,n,r)}"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s)}else p(e,s);else Object.entries(s).forEach(([t,s])=>{e.dataset[t]=s});else Array.isArray(s)?s.forEach(t=>e.removeAttribute(t)):"string"==typeof s&&e.removeAttribute(s);else Array.isArray(s)&&s.length>=2?e.setAttribute(s[0],s[1]):"object"==typeof s&&null!==s&&Object.entries(s).forEach(([t,s])=>{e.setAttribute(t,s)});else Object.entries(s).forEach(([t,s])=>{try{switch(t){case"add":Array.isArray(s)?e.classList.add(...s):"string"==typeof s&&e.classList.add(s);break;case"remove":Array.isArray(s)?e.classList.remove(...s):"string"==typeof s&&e.classList.remove(s);break;case"toggle":Array.isArray(s)?s.forEach(t=>e.classList.toggle(t)):"string"==typeof s&&e.classList.toggle(s);break;case"replace":Array.isArray(s)&&2===s.length&&e.classList.replace(s[0],s[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}});else Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,s])=>{"style"!==t||"object"!=typeof s||null===s?"classList"!==t||"object"!=typeof s||null===s?"setAttribute"!==t?"addEventListener"!==t?"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s):p(e,s):Array.isArray(s)&&s.length>=2?e.setAttribute(s[0],s[1]):"object"==typeof s&&null!==s&&Object.entries(s).forEach(([t,s])=>{e.setAttribute(t,s)}):Object.entries(s).forEach(([t,s])=>{try{switch(t){case"add":Array.isArray(s)?e.classList.add(...s):"string"==typeof s&&e.classList.add(s);break;case"remove":Array.isArray(s)?e.classList.remove(...s):"string"==typeof s&&e.classList.remove(s);break;case"toggle":Array.isArray(s)?s.forEach(t=>e.classList.toggle(t)):"string"==typeof s&&e.classList.toggle(s);break;case"replace":Array.isArray(s)&&2===s.length&&e.classList.replace(s[0],s[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}}):Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Elements helper destroyed")}isCached(e){return this.cache.has(e)}getCacheSnapshot(){return Array.from(this.cache.keys())}destructure(...e){const t={},s=[];return e.forEach(e=>{const n=this.Elements[e];n?t[e]=n:(s.push(e),t[e]=null)}),s.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${s.join(", ")}`),t}getRequired(...e){const t=this.destructure(...e),s=e.filter(e=>!t[e]);if(s.length>0)throw new Error(`Required elements not found: ${s.join(", ")}`);return t}async waitFor(...e){const t=Date.now();for(;Date.now()-t<5e3;){const t=this.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)}get(e,t=null){return this._getElement(e)||t}exists(e){return!!this._getElement(e)}getMultiple(...e){return this.destructure(...e)}destructure(...e){const t={},s=[];return e.forEach(e=>{const n=this.Elements[e];n?t[e]=n:(s.push(e),t[e]=null)}),s.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${s.join(", ")}`),t}destructure(...e){const t={},s=[];return e.forEach(e=>{const n=this._getElement(e);n?t[e]=n:(s.push(e),t[e]=null)}),s.length>0&&this.options.enableLogging&&this._warn(`Missing elements during destructuring: ${s.join(", ")}`),t}setProperty(e,t,s){const n=this.Elements[e];return!(!n||!(t in n))&&(n[t]=s,!0)}getProperty(e,t,s=void 0){const n=this.Elements[e];return n&&t in n?n[t]:s}setAttribute(e,t,s){const n=this.Elements[e];return!!n&&(n.setAttribute(t,s),!0)}getAttribute(e,t,s=null){const n=this.Elements[e];return n&&n.getAttribute(t)||s}}const _=new A({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3}),v=_.Elements;v.helper=_,v.stats=()=>_.getStats(),v.clear=()=>_.clearCache(),v.destroy=()=>_.destroy(),v.destructure=(...e)=>{const t={};return e.forEach(e=>{t[e]=document.getElementById(e)}),t},v.getRequired=(...e)=>{const t=v.destructure(...e),s=e.filter(e=>!t[e]);if(s.length>0)throw new Error(`Required elements not found: ${s.join(", ")}`);return t},v.waitFor=async(...e)=>{const t=Date.now();for(;Date.now()-t<5e3;){const t=v.destructure(...e);if(e.every(e=>t[e]))return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for elements: ${e.join(", ")}`)},v.isCached=e=>_.cache.has(e),v.get=(e,t=null)=>document.getElementById(e)||t,v.exists=e=>!!document.getElementById(e),v.getMultiple=(...e)=>{const t={};return e.forEach(e=>{t[e]=document.getElementById(e)}),t},v.setProperty=(e,t,s)=>_.setProperty(e,t,s),v.getProperty=(e,t,s)=>_.getProperty(e,t,s),v.setAttribute=(e,t,s)=>_.setAttribute(e,t,s),v.getAttribute=(e,t,s)=>_.getAttribute(e,t,s),v.configure=e=>(Object.assign(_.options,e),v),v.update=(e={})=>{if(!e||"object"!=typeof e||Array.isArray(e))return console.warn("[DOM Helpers] Elements.update() requires an object with element IDs as keys"),{};const t={},s=[],n=[];return Object.entries(e).forEach(([e,r])=>{try{const o=v[e];o&&o.nodeType===Node.ELEMENT_NODE?"function"==typeof o.update?(o.update(r),t[e]={success:!0,element:o},s.push(e)):(Object.entries(r).forEach(([e,t])=>{d(o,e,t)}),t[e]={success:!0,element:o},s.push(e)):(t[e]={success:!1,error:`Element with ID '${e}' not found`},n.push(e))}catch(s){t[e]={success:!1,error:s.message},n.push(e)}}),_.options.enableLogging&&(console.log(`[Elements] Bulk update completed: ${s.length} successful, ${n.length} failed`),n.length>0&&console.warn("[Elements] Failed IDs:",n)),t},"undefined"!=typeof module&&module.exports?module.exports={Elements:v,ProductionElementsHelper:A}:"function"==typeof define&&define.amd?define([],function(){return{Elements:v,ProductionElementsHelper:A}}):(e.Elements=v,e.ProductionElementsHelper=A),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{_.destroy()});class C{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now()},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_initProxies(){this.ClassName=this._createCollectionProxy("className"),this.TagName=this._createCollectionProxy("tagName"),this.Name=this._createCollectionProxy("name")}_createCollectionProxy(e){return new Proxy(t=>{const s=this._getCollection(e,t);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(s):s},{get:(t,s)=>{if("symbol"==typeof s||"constructor"===s||"prototype"===s||"apply"===s||"call"===s||"bind"===s||"function"==typeof t[s])return t[s];const n=this._getCollection(e,s);return this.options.enableEnhancedSyntax?this._createEnhancedCollectionProxy(n):n},apply:(e,t,s)=>s.length>0?e(s[0]):this._createEmptyCollection()})}_createEnhancedCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const s=e[parseInt(t)];return s?this._createElementProxy(s):s}return e[t]},set:(e,t,s)=>{try{return e[t]=s,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,s)=>{try{return e[t]=s,!0}catch(e){return this._warn(`Failed to set element property ${t}: ${e.message}`),!1}}}):e}_createCacheKey(e,t){return`${e}:${t}`}_getCollection(e,t){if("string"!=typeof t)return this._warn(`Invalid ${e} property type: ${typeof t}`),this._createEmptyCollection();const s=this._createCacheKey(e,t);if(this.cache.has(s)){const e=this.cache.get(s);if(this._isValidCollection(e))return this.stats.hits++,e;this.cache.delete(s)}let n;try{switch(e){case"className":n=document.getElementsByClassName(t);break;case"tagName":n=document.getElementsByTagName(t);break;case"name":n=document.getElementsByName(t);break;default:return this._warn(`Unknown collection type: ${e}`),this._createEmptyCollection()}}catch(s){return this._warn(`Error getting ${e} collection for "${t}": ${s.message}`),this._createEmptyCollection()}const r=this._enhanceCollection(n,e,t);return this._addToCache(s,r),this.stats.misses++,r}_isValidCollection(e){if(!e||!e._originalCollection)return!1;const t=e._originalCollection;if(0===t.length)return!0;const s=t[0];return s&&s.nodeType===Node.ELEMENT_NODE&&document.contains(s)}_enhanceCollection(e,t,s){const n={_originalCollection:e,_type:t,_value:s,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),namedItem:t=>e.namedItem?e.namedItem(t):null,toArray:()=>Array.from(e),forEach(t,s){Array.from(e).forEach(t,s)},map:(t,s)=>Array.from(e).map(t,s),filter:(t,s)=>Array.from(e).filter(t,s),find:(t,s)=>Array.from(e).find(t,s),some:(t,s)=>Array.from(e).some(t,s),every:(t,s)=>Array.from(e).every(t,s),reduce:(t,s)=>Array.from(e).reduce(t,s),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(s=>s[e]=t),this},setAttribute(e,t){return this.forEach(s=>s.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(s=>s.addEventListener(e,t)),this},off(e,t){return this.forEach(s=>s.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))}};for(let t=0;t<e.length;t++)Object.defineProperty(n,t,{get:()=>e[t],enumerable:!0});return n[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(n)}_createEmptyCollection(){return this._enhanceCollection({length:0,item:()=>null,namedItem:()=>null},"empty","")}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["class","name"],attributeOldValue:!0})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set,s=new Set,n=new Set;e.forEach(e=>{if([...e.addedNodes,...e.removedNodes].forEach(e=>{if(e.nodeType===Node.ELEMENT_NODE){e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&s.add(e.name),n.add(e.tagName.toLowerCase());try{(e.querySelectorAll?e.querySelectorAll("*"):[]).forEach(e=>{e.className&&e.className.split(/\s+/).forEach(e=>{e&&t.add(e)}),e.name&&s.add(e.name),n.add(e.tagName.toLowerCase())})}catch(e){}}}),"attributes"===e.type){const n=e.target;if("class"===e.attributeName){[...e.oldValue?e.oldValue.split(/\s+/):[],...n.className?n.className.split(/\s+/):[]].forEach(e=>{e&&t.add(e)})}"name"===e.attributeName&&(e.oldValue&&s.add(e.oldValue),n.name&&s.add(n.name))}});const r=[];for(const e of this.cache.keys()){const[o,i]=e.split(":",2);("className"===o&&t.has(i)||"name"===o&&s.has(i)||"tagName"===o&&n.has(i))&&r.push(e)}r.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,r.length>0&&this.options.enableLogging&&this._log(`Invalidated ${r.length} cache entries due to DOM changes`)}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,s]of this.cache)this._isValidCollection(s)||e.push(t);e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,n),t)}}_log(e){this.options.enableLogging&&console.log(`[Collections] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Collections] ${e}`)}_applyEnhancedUpdateToElement(e,t,s){d(e,t,s)}_handleClassListUpdate(e,t){Object.entries(t).forEach(([t,s])=>{try{switch(t){case"add":Array.isArray(s)?e.classList.add(...s):"string"==typeof s&&e.classList.add(s);break;case"remove":Array.isArray(s)?e.classList.remove(...s):"string"==typeof s&&e.classList.remove(s);break;case"toggle":Array.isArray(s)?s.forEach(t=>e.classList.toggle(t)):"string"==typeof s&&e.classList.toggle(s);break;case"replace":Array.isArray(s)&&2===s.length&&e.classList.replace(s[0],s[1]);break;case"contains":Array.isArray(s)?s.forEach(t=>{console.log(`[DOM Helpers] classList.contains('${t}'):`,e.classList.contains(t))}):"string"==typeof s&&console.log(`[DOM Helpers] classList.contains('${s}'):`,e.classList.contains(s));break;default:console.warn(`[DOM Helpers] Unknown classList method: ${t}`)}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}})}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(E&&E.enhanceCollectionWithUpdate)return E.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let s=[];if(e._originalCollection?s=Array.from(e._originalCollection):void 0!==e.length&&(s=Array.from(e)),0===s.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{s.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,s])=>{this._applyEnhancedUpdateToElement(e,t,s)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasEnhancedUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let s=[];if(e._originalCollection?s=Array.from(e._originalCollection):void 0!==e.length&&(s=Array.from(e)),0===s.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{s.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,s])=>{this._applyEnhancedUpdateToElement(e,t,s)})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasEnhancedUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Collections helper destroyed")}isCached(e,t){return this.cache.has(this._createCacheKey(e,t))}getCacheSnapshot(){return Array.from(this.cache.keys())}getMultiple(e){const t={};return e.forEach(({type:e,value:s,as:n})=>{const r=n||`${e}_${s}`;switch(e){case"className":t[r]=this.ClassName[s];break;case"tagName":t[r]=this.TagName[s];break;case"name":t[r]=this.Name[s]}}),t}async waitForElements(e,t,s=1,n=5e3){const r=Date.now();for(;Date.now()-r<n;){let n;switch(e){case"className":n=this.ClassName[t];break;case"tagName":n=this.TagName[t];break;case"name":n=this.Name[t];break;default:throw new Error(`Unknown collection type: ${e}`)}if(n&&n.length>=s)return n;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for ${e}="${t}" (min: ${s})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this}}const L=new C({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableEnhancedSyntax:!0}),O={ClassName:L.ClassName,TagName:L.TagName,Name:L.Name,helper:L,stats:()=>L.getStats(),clear:()=>L.clearCache(),destroy:()=>L.destroy(),isCached:(e,t)=>L.isCached(e,t),getMultiple:e=>L.getMultiple(e),waitFor:(e,t,s,n)=>L.waitForElements(e,t,s,n),enableEnhancedSyntax:()=>L.enableEnhancedSyntax(),disableEnhancedSyntax:()=>L.disableEnhancedSyntax(),configure:e=>(Object.assign(L.options,e),O),update:(e={})=>{if(!e||"object"!=typeof e||Array.isArray(e))return console.warn("[DOM Helpers] Collections.update() requires an object with collection identifiers as keys"),{};const t={},s=[],n=[];if(Object.entries(e).forEach(([e,r])=>{try{let o,i,a;if(e.includes(":"))switch([o,i]=e.split(":",2),o.toLowerCase()){case"class":case"classname":a=O.ClassName[i];break;case"tag":case"tagname":a=O.TagName[i];break;case"name":a=O.Name[i];break;default:return t[e]={success:!1,error:`Unknown collection type: ${o}. Use 'class', 'tag', or 'name'`},void n.push(e)}else a=O.ClassName[e],i=e;if(a&&a.length>0)if("function"==typeof a.update)a.update(r),t[e]={success:!0,collection:a,elementsUpdated:a.length},s.push(e);else{const n=Array.from(a);n.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(r).forEach(([t,s])=>{d(e,t,s)})}),t[e]={success:!0,collection:a,elementsUpdated:n.length},s.push(e)}else a?(t[e]={success:!0,collection:a,elementsUpdated:0,warning:"Collection is empty - no elements to update"},s.push(e)):(t[e]={success:!1,error:`Collection '${e}' not found or invalid`},n.push(e))}catch(s){t[e]={success:!1,error:s.message},n.push(e)}}),L.options.enableLogging){const e=s.reduce((e,s)=>e+(t[s].elementsUpdated||0),0);console.log(`[Collections] Bulk update completed: ${s.length} collections (${e} elements), ${n.length} failed`),n.length>0&&console.warn("[Collections] Failed identifiers:",n)}return t}};"undefined"!=typeof module&&module.exports?module.exports={Collections:O,ProductionCollectionHelper:C}:"function"==typeof define&&define.amd?define([],function(){return{Collections:O,ProductionCollectionHelper:C}}):(e.Collections=O,e.ProductionCollectionHelper=C),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{L.destroy()});class S{constructor(e={}){this.cache=new Map,this.weakCache=new WeakMap,this.options={enableLogging:e.enableLogging??!1,autoCleanup:e.autoCleanup??!0,cleanupInterval:e.cleanupInterval??3e4,maxCacheSize:e.maxCacheSize??1e3,debounceDelay:e.debounceDelay??16,enableSmartCaching:e.enableSmartCaching??!0,enableEnhancedSyntax:e.enableEnhancedSyntax??!0,...e},this.stats={hits:0,misses:0,cacheSize:0,lastCleanup:Date.now(),selectorTypes:new Map},this.pendingUpdates=new Set,this.cleanupTimer=null,this.isDestroyed=!1,this.selectorPatterns=this._buildSelectorPatterns(),this._initProxies(),this._initMutationObserver(),this._scheduleCleanup()}_buildSelectorPatterns(){return{id:/^#([a-zA-Z][\w-]*)$/,class:/^\.([a-zA-Z][\w-]*)$/,tag:/^([a-zA-Z][a-zA-Z0-9]*)$/,attribute:/^\[([^\]]+)\]$/,descendant:/^(\w+)\s+(\w+)$/,child:/^(\w+)\s*>\s*(\w+)$/,pseudo:/^(\w+):([a-zA-Z-]+)$/}}_initProxies(){this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this.options.enableEnhancedSyntax&&this._initEnhancedSyntax(),this.Scoped={within:(e,t)=>{const s="string"==typeof e?document.querySelector(e):e;if(!s)return null;const n=`scoped:${s.id||"anonymous"}:${t}`;return this._getScopedQuery(s,t,"single",n)},withinAll:(e,t)=>{const s="string"==typeof e?document.querySelector(e):e;if(!s)return this._createEmptyCollection();const n=`scopedAll:${s.id||"anonymous"}:${t}`;return this._getScopedQuery(s,t,"multiple",n)}}}_initEnhancedSyntax(){const e=this.query;this.query=new Proxy(e,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const s=this._normalizeSelector(t),n=this._getQuery("single",s);return n?this._createElementProxy(n):n},apply:(e,t,s)=>s.length>0?this._getQuery("single",s[0]):null});const t=this.queryAll;this.queryAll=new Proxy(t,{get:(e,t)=>{if("symbol"==typeof t||"constructor"===t||"prototype"===t||"apply"===t||"call"===t||"bind"===t||"function"==typeof e[t])return e[t];const s=this._normalizeSelector(t),n=this._getQuery("multiple",s);return this._createCollectionProxy(n)},apply:(e,t,s)=>s.length>0?this._getQuery("multiple",s[0]):this._createEmptyCollection()})}_createElementProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>e[t],set:(e,t,s)=>{try{return e[t]=s,!0}catch(e){return this._warn(`Failed to set property ${t}: ${e.message}`),!1}}}):e}_createCollectionProxy(e){return e&&this.options.enableEnhancedSyntax?new Proxy(e,{get:(e,t)=>{if(!isNaN(t)&&parseInt(t)>=0){const s=e[parseInt(t)];return s?this._createElementProxy(s):s}return e[t]},set:(e,t,s)=>{try{return e[t]=s,!0}catch(e){return this._warn(`Failed to set collection property ${t}: ${e.message}`),!1}}}):e}_createQueryFunction(e){const t=t=>this._getQuery(e,t);return t._queryType=e,t._helper=this,t}_normalizeSelector(e){const t=e.toString(),s=e=>`#${this._camelToKebab(e)}`,n=e=>`.${this._camelToKebab(e)}`;return t.startsWith("id")&&t.length>2?s(t.slice(2)):t.startsWith("class")&&t.length>5?n(t.slice(5)):/^[a-z][a-zA-Z]*$/.test(t)&&/[A-Z]/.test(t)?n(t):/^[a-z]+$/.test(t)&&t.length<10?t:t.match(/^[a-zA-Z][\w-]*$/)?`#${t}`:t}_camelToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}_createCacheKey(e,t){return`${e}:${t}`}_getQuery(e,t){if("string"!=typeof t)return this._warn("Invalid selector type: "+typeof t),"single"===e?null:this._createEmptyCollection();const s=this._createCacheKey(e,t);if(this.cache.has(s)){const n=this.cache.get(s);if(this._isValidQuery(n,e))return this.stats.hits++,this._trackSelectorType(t),n;this.cache.delete(s)}let n;try{if("single"===e){const e=document.querySelector(t);n=this._enhanceElementWithUpdate(e)}else{const e=document.querySelectorAll(t);n=this._enhanceNodeList(e,t)}}catch(s){return this._warn(`Invalid selector "${t}": ${s.message}`),"single"===e?null:this._createEmptyCollection()}return this._addToCache(s,n),this.stats.misses++,this._trackSelectorType(t),n}_getScopedQuery(e,t,s,n){if(this.cache.has(n)){const e=this.cache.get(n);if(this._isValidQuery(e,s))return this.stats.hits++,e;this.cache.delete(n)}let r;try{if("single"===s)r=e.querySelector(t);else{const s=e.querySelectorAll(t);r=this._enhanceNodeList(s,t)}}catch(e){return this._warn(`Invalid scoped selector "${t}": ${e.message}`),"single"===s?null:this._createEmptyCollection()}return this._addToCache(n,r),this.stats.misses++,r}_isValidQuery(e,t){if("single"===t)return e&&e.nodeType===Node.ELEMENT_NODE&&document.contains(e);{if(!e||!e._originalNodeList)return!1;const t=e._originalNodeList;if(0===t.length)return!0;const s=t[0];return s&&document.contains(s)}}_enhanceNodeList(e,t){const s={_originalNodeList:e,_selector:t,_cachedAt:Date.now(),get length(){return e.length},item:t=>e.item(t),entries:()=>e.entries(),keys:()=>e.keys(),values:()=>e.values(),toArray:()=>Array.from(e),forEach(t,s){e.forEach(t,s)},map:(t,s)=>Array.from(e).map(t,s),filter:(t,s)=>Array.from(e).filter(t,s),find:(t,s)=>Array.from(e).find(t,s),some:(t,s)=>Array.from(e).some(t,s),every:(t,s)=>Array.from(e).every(t,s),reduce:(t,s)=>Array.from(e).reduce(t,s),first:()=>e.length>0?e[0]:null,last:()=>e.length>0?e[e.length-1]:null,at:t=>(t<0&&(t=e.length+t),t>=0&&t<e.length?e[t]:null),isEmpty:()=>0===e.length,addClass(e){return this.forEach(t=>t.classList.add(e)),this},removeClass(e){return this.forEach(t=>t.classList.remove(e)),this},toggleClass(e){return this.forEach(t=>t.classList.toggle(e)),this},setProperty(e,t){return this.forEach(s=>s[e]=t),this},setAttribute(e,t){return this.forEach(s=>s.setAttribute(e,t)),this},setStyle(e){return this.forEach(t=>{Object.assign(t.style,e)}),this},on(e,t){return this.forEach(s=>s.addEventListener(e,t)),this},off(e,t){return this.forEach(s=>s.removeEventListener(e,t)),this},visible(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"!==t.display&&"hidden"!==t.visibility&&"0"!==t.opacity})},hidden(){return this.filter(e=>{const t=window.getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility||"0"===t.opacity})},enabled(){return this.filter(e=>!e.disabled&&!e.hasAttribute("disabled"))},disabled(){return this.filter(e=>e.disabled||e.hasAttribute("disabled"))},within(e){const t=[];return this.forEach(s=>{const n=s.querySelectorAll(e);t.push(...Array.from(n))}),this._helper._enhanceNodeList(t,`${this._selector} ${e}`)}};for(let t=0;t<e.length;t++)Object.defineProperty(s,t,{get:()=>e[t],enumerable:!0});return s[Symbol.iterator]=function*(){for(let t=0;t<e.length;t++)yield e[t]},this._enhanceCollectionWithUpdate(s)}_createEmptyCollection(){const e=document.querySelectorAll("nonexistent-element-that-never-exists");return this._enhanceNodeList(e,"empty")}_trackSelectorType(e){const t=this._classifySelector(e),s=this.stats.selectorTypes.get(t)||0;this.stats.selectorTypes.set(t,s+1)}_classifySelector(e){return this.selectorPatterns.id.test(e)?"id":this.selectorPatterns.class.test(e)?"class":this.selectorPatterns.tag.test(e)?"tag":this.selectorPatterns.attribute.test(e)?"attribute":this.selectorPatterns.descendant.test(e)?"descendant":this.selectorPatterns.child.test(e)?"child":this.selectorPatterns.pseudo.test(e)?"pseudo":"complex"}_addToCache(e,t){if(this.cache.size>=this.options.maxCacheSize){const e=this.cache.keys().next().value;this.cache.delete(e)}this.cache.set(e,t),this.stats.cacheSize=this.cache.size,t&&t.nodeType===Node.ELEMENT_NODE&&this.weakCache.set(t,{cacheKey:e,cachedAt:Date.now(),accessCount:1})}_initMutationObserver(){if(!this.options.enableSmartCaching)return;const e=this._debounce(e=>{this._processMutations(e)},this.options.debounceDelay);this.observer=new MutationObserver(e),document.body?this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]}):document.addEventListener("DOMContentLoaded",()=>{document.body&&!this.isDestroyed&&this.observer.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["id","class","style","hidden","disabled"]})})}_processMutations(e){if(this.isDestroyed)return;const t=new Set;if(e.forEach(e=>{if("childList"===e.type&&t.add("*"),"attributes"===e.type){const s=e.target,n=e.attributeName;if("id"===n){const n=e.oldValue;n&&t.add(`#${n}`),s.id&&t.add(`#${s.id}`)}if("class"===n){[...e.oldValue?e.oldValue.split(/\s+/):[],...s.className?s.className.split(/\s+/):[]].forEach(e=>{e&&t.add(`.${e}`)})}t.add(`[${n}]`)}}),t.has("*"))this.cache.clear();else{const e=[];for(const s of this.cache.keys()){const[n,r]=s.split(":",2);for(const n of t)if(r.includes(n)){e.push(s);break}}e.forEach(e=>this.cache.delete(e))}this.stats.cacheSize=this.cache.size}_scheduleCleanup(){this.options.autoCleanup&&!this.isDestroyed&&(this.cleanupTimer=setTimeout(()=>{this._performCleanup(),this._scheduleCleanup()},this.options.cleanupInterval))}_performCleanup(){if(this.isDestroyed)return;this.cache.size;const e=[];for(const[t,s]of this.cache){const[n]=t.split(":",1);this._isValidQuery(s,"single"===n?"single":"multiple")||e.push(t)}e.forEach(e=>this.cache.delete(e)),this.stats.cacheSize=this.cache.size,this.stats.lastCleanup=Date.now(),this.options.enableLogging&&e.length>0&&this._log(`Cleanup completed. Removed ${e.length} stale entries.`)}_debounce(e,t){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>e.apply(this,n),t)}}_log(e){this.options.enableLogging&&console.log(`[Selector] ${e}`)}_warn(e){this.options.enableLogging&&console.warn(`[Selector] ${e}`)}_enhanceElementWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(E&&E.enhanceElementWithUpdate)return E.enhanceElementWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,s])=>{"style"!==t||"object"!=typeof s||null===s?"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s):Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,s])=>{"style"!==t||"object"!=typeof s||null===s?"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s):Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}_enhanceCollectionWithUpdate(e){if(!e||e._hasEnhancedUpdateMethod)return e;if(e._originalCollection&&Array.from(e._originalCollection).forEach(e=>{e&&(e.nodeType,Node.ELEMENT_NODE)}),E&&E.enhanceCollectionWithUpdate)return E.enhanceCollectionWithUpdate(e);try{Object.defineProperty(e,"update",{value:(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let s=[];if(e._originalNodeList?s=Array.from(e._originalNodeList):void 0!==e.length&&(s=Array.from(e)),0===s.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{s.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,s])=>{"style"!==t||"object"!=typeof s||null===s?"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s):Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=(t={})=>{if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;let s=[];if(e._originalNodeList?s=Array.from(e._originalNodeList):void 0!==e.length&&(s=Array.from(e)),0===s.length)return console.info("[DOM Helpers] .update() called on empty collection"),e;try{s.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(t).forEach(([t,s])=>{"style"!==t||"object"!=typeof s||null===s?"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s):Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})})}catch(e){console.warn(`[DOM Helpers] Error in collection .update(): ${e.message}`)}return e},e._hasUpdateMethod=!0}return e}getStats(){return{...this.stats,hitRate:this.stats.hits/(this.stats.hits+this.stats.misses)||0,uptime:Date.now()-this.stats.lastCleanup,selectorBreakdown:Object.fromEntries(this.stats.selectorTypes)}}clearCache(){this.cache.clear(),this.stats.cacheSize=0,this.stats.selectorTypes.clear(),this._log("Cache cleared manually")}destroy(){this.isDestroyed=!0,this.observer&&(this.observer.disconnect(),this.observer=null),this.cleanupTimer&&(clearTimeout(this.cleanupTimer),this.cleanupTimer=null),this.cache.clear(),this._log("Selector helper destroyed")}async waitForSelector(e,t=5e3){const s=Date.now();for(;Date.now()-s<t;){const t=this.query(e);if(t)return t;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e}`)}async waitForSelectorAll(e,t=1,s=5e3){const n=Date.now();for(;Date.now()-n<s;){const s=this.queryAll(e);if(s&&s.length>=t)return s;await new Promise(e=>setTimeout(e,100))}throw new Error(`Timeout waiting for selector: ${e} (min: ${t})`)}enableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!0,this._initEnhancedSyntax(),this}disableEnhancedSyntax(){return this.options.enableEnhancedSyntax=!1,this.query=this._createQueryFunction("single"),this.queryAll=this._createQueryFunction("multiple"),this}}const M=new S({enableLogging:!1,autoCleanup:!0,cleanupInterval:3e4,maxCacheSize:1e3,enableSmartCaching:!0,enableEnhancedSyntax:!0}),D={query:M.query,queryAll:M.queryAll,Scoped:M.Scoped,helper:M,stats:()=>M.getStats(),clear:()=>M.clearCache(),destroy:()=>M.destroy(),waitFor:(e,t)=>M.waitForSelector(e,t),waitForAll:(e,t,s)=>M.waitForSelectorAll(e,t,s),enableEnhancedSyntax:()=>M.enableEnhancedSyntax(),disableEnhancedSyntax:()=>M.disableEnhancedSyntax(),configure:e=>(Object.assign(M.options,e),D),update:(e={})=>{if(!e||"object"!=typeof e||Array.isArray(e))return console.warn("[DOM Helpers] Selector.update() requires an object with CSS selectors as keys"),{};const t={},s=[],n=[];if(Object.entries(e).forEach(([e,r])=>{try{const n=D.queryAll(e);if(n&&n.length>0)if("function"==typeof n.update)n.update(r),t[e]={success:!0,elements:n,elementsUpdated:n.length},s.push(e);else{const o=Array.from(n);o.forEach(e=>{e&&e.nodeType===Node.ELEMENT_NODE&&Object.entries(r).forEach(([t,s])=>{d(e,t,s)})}),t[e]={success:!0,elements:n,elementsUpdated:o.length},s.push(e)}else t[e]={success:!0,elements:null,elementsUpdated:0,warning:"No elements found matching selector"},s.push(e)}catch(s){t[e]={success:!1,error:s.message},n.push(e)}}),M.options.enableLogging){const e=s.reduce((e,s)=>e+(t[s].elementsUpdated||0),0);console.log(`[Selector] Bulk update completed: ${s.length} selectors (${e} elements), ${n.length} failed`),n.length>0&&console.warn("[Selector] Failed selectors:",n)}return t}};"undefined"!=typeof module&&module.exports?module.exports={Selector:D,ProductionSelectorHelper:S}:"function"==typeof define&&define.amd?define([],function(){return{Selector:D,ProductionSelectorHelper:S}}):(e.Selector=D,e.ProductionSelectorHelper=S),"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{M.destroy()});const j={Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper,version:"2.3.1",isReady(){return!!(this.Elements&&this.Collections&&this.Selector)},getStats(){const e={};return this.Elements&&"function"==typeof this.Elements.stats&&(e.elements=this.Elements.stats()),this.Collections&&"function"==typeof this.Collections.stats&&(e.collections=this.Collections.stats()),this.Selector&&"function"==typeof this.Selector.stats&&(e.selector=this.Selector.stats()),e},clearAll(){this.Elements&&"function"==typeof this.Elements.clear&&this.Elements.clear(),this.Collections&&"function"==typeof this.Collections.clear&&this.Collections.clear(),this.Selector&&"function"==typeof this.Selector.clear&&this.Selector.clear()},destroyAll(){this.Elements&&"function"==typeof this.Elements.destroy&&this.Elements.destroy(),this.Collections&&"function"==typeof this.Collections.destroy&&this.Collections.destroy(),this.Selector&&"function"==typeof this.Selector.destroy&&this.Selector.destroy()},configure(e={}){return this.Elements&&"function"==typeof this.Elements.configure&&this.Elements.configure(e.elements||e),this.Collections&&"function"==typeof this.Collections.configure&&this.Collections.configure(e.collections||e),this.Selector&&"function"==typeof this.Selector.configure&&this.Selector.configure(e.selector||e),this}};"undefined"!=typeof module&&module.exports?module.exports={DOMHelpers:j,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}:"function"==typeof define&&define.amd?define([],function(){return{DOMHelpers:j,Elements:e.Elements,Collections:e.Collections,Selector:e.Selector,ProductionElementsHelper:e.ProductionElementsHelper,ProductionCollectionHelper:e.ProductionCollectionHelper,ProductionSelectorHelper:e.ProductionSelectorHelper}}):e.DOMHelpers=j,"undefined"!=typeof window&&window.addEventListener("beforeunload",()=>{j.destroyAll()}),function(){const s=document.createElement;function n(e,t){const n=s.call(document,e,t);return m(n)}function r(e={}){if(!e||"object"!=typeof e)return console.warn("[DOM Helpers] createElement.bulk() requires an object"),null;const r={},i=[];return Object.entries(e).forEach(([e,a])=>{try{let l=e;const c=e.match(/^([A-Z]+)(_\d+)?$/i);c&&(l=c[1]);const h=t?n(l):s.call(document,l);a&&"object"==typeof a&&Object.entries(a).forEach(([t,s])=>{try{if("style"===t&&"object"==typeof s&&null!==s)return void Object.assign(h.style,s);if("classList"===t&&"object"==typeof s&&null!==s)return void Object.entries(s).forEach(([e,t])=>{try{switch(e){case"add":const e=Array.isArray(t)?t:[t];h.classList.add(...e);break;case"remove":const s=Array.isArray(t)?t:[t];h.classList.remove(...s);break;case"toggle":(Array.isArray(t)?t:[t]).forEach(e=>h.classList.toggle(e));break;case"replace":Array.isArray(t)&&2===t.length&&h.classList.replace(t[0],t[1])}}catch(t){console.warn(`[DOM Helpers] Error in classList.${e}: ${t.message}`)}});if("setAttribute"===t)return void("object"!=typeof s||Array.isArray(s)?Array.isArray(s)&&s.length>=2&&h.setAttribute(s[0],s[1]):Object.entries(s).forEach(([e,t])=>{h.setAttribute(e,t)}));if("dataset"===t&&"object"==typeof s&&null!==s)return void Object.entries(s).forEach(([e,t])=>{h.dataset[e]=t});if("addEventListener"===t){if(Array.isArray(s)&&s.length>=2){const[e,t,n]=s;h.addEventListener(e,t,n)}else"object"==typeof s&&null!==s&&Object.entries(s).forEach(([e,t])=>{if("function"==typeof t)h.addEventListener(e,t);else if(Array.isArray(t)&&t.length>=1){const[s,n]=t;h.addEventListener(e,s,n)}});return}if("removeAttribute"===t)return void(Array.isArray(s)?s.forEach(e=>h.removeAttribute(e)):"string"==typeof s&&h.removeAttribute(s));if("function"==typeof h[t])return void(Array.isArray(s)?h[t](...s):h[t](s));if(t in h)return void(h[t]=s);"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s||h.setAttribute(t,String(s))}catch(s){console.warn(`[DOM Helpers] Failed to apply config ${t} to ${e}:`,s.message)}}),h._hasUpdateMethod||t||o(h),r[e]=h,i.push({key:e,element:h})}catch(t){console.warn(`[DOM Helpers] Failed to create element ${e}:`,t.message)}}),{...r,toArray:(...e)=>0===e.length?i.map(({element:e})=>e):e.map(e=>r[e]).filter(Boolean),ordered(...e){return this.toArray(...e)},get all(){return i.map(({element:e})=>e)},updateMultiple(e={}){return Object.entries(e).forEach(([e,t])=>{const s=r[e];s&&("function"==typeof s.update?s.update(t):Object.entries(t).forEach(([t,n])=>{try{"style"===t&&"object"==typeof n&&null!==n?Object.assign(s.style,n):t in s?s[t]=n:"string"!=typeof n&&"number"!=typeof n||s.setAttribute(t,n)}catch(s){console.warn(`[DOM Helpers] Failed to update ${t} on ${e}:`,s.message)}}))}),this},get count(){return i.length},get keys(){return i.map(({key:e})=>e)},has:e=>e in r,get:(e,t=null)=>r[e]||t,forEach(e){i.forEach(({key:t,element:s},n)=>{e(s,t,n)})},map:e=>i.map(({key:t,element:s},n)=>e(s,t,n)),filter:e=>i.filter(({key:t,element:s},n)=>e(s,t,n)).map(({element:e})=>e),appendTo(e){const t="string"==typeof e?document.querySelector(e):e;return t&&this.all.forEach(e=>t.appendChild(e)),this},appendToOrdered(e,...t){const s="string"==typeof e?document.querySelector(e):e;return s&&this.ordered(...t).forEach(e=>{e&&s.appendChild(e)}),this}}}function o(e){if(e&&!e._hasUpdateMethod)try{Object.defineProperty(e,"update",{value:function(t={}){if(!t||"object"!=typeof t)return console.warn("[DOM Helpers] .update() called with invalid updates object"),e;try{Object.entries(t).forEach(([t,s])=>{if("style"!==t||"object"!=typeof s||null===s)if("classList"!==t||"object"!=typeof s||null===s)if("setAttribute"===t&&Array.isArray(s)&&s.length>=2)e.setAttribute(s[0],s[1]);else if("removeAttribute"!==t)if("dataset"!==t||"object"!=typeof s||null===s){if("addEventListener"===t&&Array.isArray(s)&&s.length>=2){const[t,n,r]=s;return void e.addEventListener(t,n,r)}"function"!=typeof e[t]?t in e?e[t]=s:"string"!=typeof s&&"number"!=typeof s&&"boolean"!=typeof s||e.setAttribute(t,s):Array.isArray(s)?e[t](...s):e[t](s)}else Object.entries(s).forEach(([t,s])=>{e.dataset[t]=s});else Array.isArray(s)?s.forEach(t=>e.removeAttribute(t)):"string"==typeof s&&e.removeAttribute(s);else Object.entries(s).forEach(([t,s])=>{try{switch(t){case"add":Array.isArray(s)?e.classList.add(...s):"string"==typeof s&&e.classList.add(s);break;case"remove":Array.isArray(s)?e.classList.remove(...s):"string"==typeof s&&e.classList.remove(s);break;case"toggle":Array.isArray(s)?s.forEach(t=>e.classList.toggle(t)):"string"==typeof s&&e.classList.toggle(s);break;case"replace":Array.isArray(s)&&2===s.length&&e.classList.replace(s[0],s[1])}}catch(e){console.warn(`[DOM Helpers] Error in classList.${t}: ${e.message}`)}});else Object.entries(s).forEach(([t,s])=>{null!=s&&(e.style[t]=s)})})}catch(e){console.warn(`[DOM Helpers] Error in .update(): ${e.message}`)}return e},writable:!1,enumerable:!1,configurable:!0}),Object.defineProperty(e,"_hasUpdateMethod",{value:!0,writable:!1,enumerable:!1,configurable:!1})}catch(t){e.update=function(e={}){},e._hasUpdateMethod=!0}return e}function n(e,t){let n;return t&&"object"==typeof t&&!t.is&&(t.textContent||t.className||t.style||t.id||t.classList||t.setAttribute)?(n=s.call(document,e),n=m(n),n.update(t)):(n=s.call(document,e,t),n=m(n)),n}n.bulk=r,n.update=r,t&&(document.createElement=n),void 0!==e.DOMHelpers&&(e.DOMHelpers.enableCreateElementEnhancement=function(){return document.createElement=n,this},e.DOMHelpers.disableCreateElementEnhancement=function(){return document.createElement=s,this}),document.createElement.restore=function(){document.createElement=s},void 0!==e.DOMHelpers&&(e.DOMHelpers.createElement=n),e.createElement=n}()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this);